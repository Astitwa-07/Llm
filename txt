import os
import pytesseract
from googletrans import Translator
from PyPDF2 import PdfWriter
import pdfplumber

def extract_text_from_pdf(pdf_file):
    with pdfplumber.open(pdf_file) as pdf:
        text = ""
        for page in pdf.pages:
            page_text = page.extract_text()
            if page_text is not None:
                text += page_text
    return text

def extract_text_from_image(image_file):
    image_text = pytesseract.image_to_string(image_file, lang='deu')
    return image_text.strip()  # Remove leading/trailing whitespaces

# Rest of the functions remain the same as in the previous code snippet...

def convert_pdf_to_english(input_folder, output_folder):
    os.makedirs(output_folder, exist_ok=True)

    for file_name in os.listdir(input_folder):
        if file_name.lower().endswith('.pdf'):
            input_file = os.path.join(input_folder, file_name)
            pdf_text = extract_text_from_pdf(input_file)

            image_files = [file for file in os.listdir(input_folder) if file.lower().endswith(('.png', '.jpg', '.jpeg'))]
            for image_file in image_files:
                image_path = os.path.join(input_folder, image_file)
                image_text = extract_text_from_image(image_path)
                pdf_text += image_text

            translated_text = translate_text(pdf_text)
            cleaned_text = clean_text(translated_text)

            output_file = os.path.join(output_folder, file_name[:-4] + '_translated.pdf')
            save_text_to_pdf(cleaned_text, output_file)

if __name__ == "__main__":
    input_folder_path = "/path/to/input/folder"
    output_folder_path = "/path/to/output/folder"
    convert_pdf_to_english(input_folder_path, output_folder_path)